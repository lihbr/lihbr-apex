[build]
base = ""
command = "npm run build"
publish = "dist/vite/"
functions = "src/_functions/"

  [build.environment]
  NODE_VERSION = "16.6.1"

  [build.processing]
  skip_processing = false

    [build.processing.html]
    pretty_urls = false

    [build.processing.css]
    bundle = false
    minify = false

    [build.processing.js]
    bundle = false
    minify = false

    [build.processing.images]
    compress = true

[dev]
framework = "#custom"
command = "npm run dev"
port = 8_888
targetPort = 3_000
autoLaunch = false

[context.production.processing]
skip_processing = false

[context.deploy-preview.processing]
skip_processing = true

[context.branch-deploy]
command = "npm run build:staging"

  [context.branch-deploy.processing]
  skip_processing = true

[[redirects]]
from = "/notes/:id"
to = "/.netlify/functions/notes"
status = 200
force = true
_generated_by_eleventy_serverless = "notes"

[[redirects]]
from = "/preview/records"
to = "/.netlify/functions/preview"
status = 200
force = true
_generated_by_eleventy_serverless = "preview"

[[redirects]]
from = "/preview/blog/:uid"
to = "/.netlify/functions/preview"
status = 200
force = true
_generated_by_eleventy_serverless = "preview"

[[redirects]]
from = "/preview/:uid"
to = "/.netlify/functions/preview"
status = 200
force = true
_generated_by_eleventy_serverless = "preview"

[[redirects]]
from = "/preview"
to = "/.netlify/functions/preview"
status = 200
force = true

[[redirects]]
from = "/api/v1/*"
to = "/.netlify/functions/:splat"
status = 200
force = true

[[redirects]]
from = "https://lihbr.netlify.app/*"
to = "https://lihbr.com/:splat"
status = 301
force = true

[[redirects]]
from = "/talk/:slug/diapositiv"
to = "https://:slug.diapositiv.lihbr.com/1"
status = 301
force = true

[[redirects]]
from = "/p7e/js/script.js"
to = "https://plausible.io/js/plausible.js"
status = 200
force = true

[[redirects]]
from = "/p7e/api/event"
to = "https://plausible.io/api/event"
status = 202
force = true
